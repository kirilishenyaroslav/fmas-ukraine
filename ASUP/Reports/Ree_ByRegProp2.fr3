<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Name="" Version="3.15" DotMatrixReport="False" EngineOptions.ConvertNulls="False" EngineOptions.DoublePass="True" EngineOptions.MaxMemSize="10000000" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="1073" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" ReportOptions.CreateDate="38464,5474027546" ReportOptions.Description.Text="" ReportOptions.LastChange="38707,6079631713" ScriptLanguage="PascalScript" ScriptText.Text="var PLine:integer=0;&#13;&#10;&#13;&#10;    GroupNo: Integer;               // номер группы&#13;&#10;    MHeight: array of Extended;     // массив высот заголовок группы + первая запись&#13;&#10;    LastLine: Integer;              // номер последней записи в главном наборе&#13;&#10;    FHeight: Extended;              // высота итогов&#13;&#10;    LastGroup: Integer;             // номер последней группы&#13;&#10;    LastGroupOneRow: Boolean;       // последня группа из одной строки?&#13;&#10;    NeededHeight: Extended;         // нужная высота&#13;&#10;&#13;&#10;procedure ReportTitle1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  PLine:=0;&#13;&#10;  GroupNo := 0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo12OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  inc(Pline);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportSummary1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     // 1й проход: запомнить высоту итогов&#13;&#10;     with Engine, ReportSummary1 do&#13;&#10;     if not FinalPass and Visible then&#13;&#10;        FHeight := Height;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DetailData1, Engine do&#13;&#10;  begin&#13;&#10;         // проверить, одна ли строка данных в последней группе&#13;&#10;     if not FinalPass then&#13;&#10;            if &#60;Line&#62; &#62; 1 then LastGroupOneRow := False&#13;&#10;            else LastGroupOneRow := True;&#13;&#10;&#13;&#10;         // если не хватает места для последней записи&#13;&#10;         // с итогами, сформировать новую страницу&#13;&#10;     if FinalPass then&#13;&#10;        if ( &#60;Line#&#62; =  LastLine )&#13;&#10;           and ( FreeSpace &#60; Height + FHeight )&#13;&#10;        then NewPage;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       with MasterData1, Engine do&#13;&#10;       begin&#13;&#10;              // 1й проход: прибавить к высоте заголовка группы&#13;&#10;              // высоту первой записи&#13;&#10;          if not FinalPass and (&#60;Line&#62; = 1) then&#13;&#10;             MHeight[GroupNo] := MHeight[GroupNo] + Height;&#13;&#10;&#13;&#10;                // 1й проход: обновить общее количество записей&#13;&#10;          if not FinalPass then&#13;&#10;               LastLine := &#60;Line#&#62;;&#13;&#10;       end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with MasterData1, Engine do&#13;&#10;  begin&#13;&#10;         // увеличить номер группы&#13;&#10;     inc(GroupNo);&#13;&#10;         // обновить номер последней группы&#13;&#10;     if not FinalPass then LastGroup := GroupNo;&#13;&#10;&#13;&#10;         // 2й проход: если не хватает места для&#13;&#10;         // заголовка группы и первой записи,&#13;&#10;         // перейти на следующую страницу&#13;&#10;         // а если группа последняя, и только одна&#13;&#10;         // строка с данными, проверить, хватит ли&#13;&#10;         // места для группы, данных и итогов&#13;&#10;     if FinalPass then&#13;&#10;     begin&#13;&#10;       NeededHeight := MHeight[GroupNo];&#13;&#10;       if ( GroupNo = LastGroup ) and LastGroupOneRow then&#13;&#10;               NeededHeight := NeededHeight + FHeight;&#13;&#10;&#13;&#10;       if FreeSpace &#60; NeededHeight then NewPage;&#13;&#10;     end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       with MasterData1, Engine do&#13;&#10;       begin&#13;&#10;            // 1й проход: запомнить высоту заголовка группы&#13;&#10;            if not FinalPass then&#13;&#10;            begin&#13;&#10;                SetLength(MHeight, GroupNo+1);&#13;&#10;                MHeight[GroupNo] := Height;&#13;&#10;            end;&#13;&#10;       end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403A80008446174617365747301010C3600000020446174615365743D225265706F727444736574446174612220446174615365744E616D653D225265706F727444736574446174612200010C4200000020446174615365743D225265706F7274445365744461746150656F706C652220446174615365744E616D653D225265706F7274445365744461746150656F706C652200010C4200000020446174615365743D225265706F727444536574476C6F62616C446174612220446174615365744E616D653D225265706F727444736574476C6F62616C44617461220000095661726961626C657301010C16000000204E616D653D2220557365722043617465676F72792200010C30000000204E616D653D2250537069736F6B222056616C75653D2227D1CFC8D1CECA20CAC0CDC4C8C4C0D2B2C220CDC0D3CA27220000055374796C650100">
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxPageHeader Name="PageHeader1" Height="22,67718" Left="0" Top="102,04731" Width="718,1107" PrintOnFirstPage="False">
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="143,62214" Height="18,89765" HAlign="haRight" Memo.Text="Маш. дата: [date]"/>
      <TfrxMemoView Name="Memo2" Left="502,67749" Top="0" Width="215,43321" Height="18,89765" HAlign="haRight" Memo.Text="стор. [&#60;Page&#62;] з [&#60;TotalPages&#62;]"/>
    </TfrxPageHeader>
    <TfrxReportTitle Name="ReportTitle1" Height="60,47248" Left="0" Top="18,89765" Width="718,1107" OnBeforePrint="ReportTitle1OnBeforePrint">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="143,62214" Height="18,89765" HAlign="haRight" Memo.Text="Маш. дата: [date]"/>
      <TfrxMemoView Name="Memo4" Left="502,67749" Top="0" Width="215,43321" Height="18,89765" HAlign="haRight" Memo.Text="стор. [&#60;Page&#62;] з [&#60;TotalPages&#62;]"/>
      <TfrxMemoView Name="Memo6" Left="0" Top="37,7953" Width="718,1107" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" Memo.Text="[PSpisok]" ParentFont="False"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="18,89765" Width="718,1107" Height="18,89765" DataField="FIRM_NAME" DataSet="ReportDSetGlobalData" DataSetName="ReportDsetGlobalData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Memo.Text="[ReportDsetGlobalData.&#34;FIRM_NAME&#34;]" ParentFont="False"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="238,11039" Width="718,1107" OnAfterCalcHeight="MasterData1OnAfterCalcHeight" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ReportDsetData" DataSetName="ReportDsetData" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="718,1107" Height="18,89765" StretchMode="smMaxHeight" Color="14145495" DataField="NAME_DEPARTMENT" DataSet="ReportDsetData" DataSetName="ReportDsetData" Frame.Typ="15" Memo.Text="[ReportDsetData.&#34;NAME_DEPARTMENT&#34;]"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" Height="18,89765" Left="0" Top="279,68522" Width="718,1107" OnAfterCalcHeight="DetailData1OnAfterCalcHeight" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo8" Left="26,45671" Top="0" Width="188,9765" Height="18,89765" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[P_FIO]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo9" Left="551,81138" Top="0" Width="113,3859" Height="18,89765" StretchMode="smMaxHeight" DataField="ALL_UCH_ZVANIE" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[ReportDSetDataPeople.&#34;ALL_UCH_ZVANIE&#34;]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo10" Left="359,05535" Top="0" Width="192,75603" Height="18,89765" StretchMode="smMaxHeight" DataField="ALL_UCH_STEPEN" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[ReportDSetDataPeople.&#34;ALL_UCH_STEPEN&#34;]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo11" Left="215,43321" Top="0" Width="143,62214" Height="18,89765" StretchMode="smMaxHeight" DataField="NAME_POST" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[ReportDSetDataPeople.&#34;NAME_POST&#34;]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="0" Width="26,45671" Height="18,89765" OnBeforePrint="Memo12OnBeforePrint" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" Memo.Text="[Pline]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo13" Left="665,19728" Top="0" Width="52,91342" Height="18,89765" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" Memo.Text="" ParentFont="False" VAlign="vaCenter"/>
    </TfrxDetailData>
    <TfrxHeader Name="Header1" Height="30,23624" Left="0" Top="185,19697" Width="718,1107" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo14" Left="26,45671" Top="0" Width="188,9765" Height="30,23624" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="П.І.Б." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo15" Left="551,81138" Top="0" Width="113,3859" Height="30,23624" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Вчене звання, дата присв." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo16" Left="359,05535" Top="0" Width="192,75603" Height="30,23624" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Вч. ступінь, № дипл." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo17" Left="215,43321" Top="0" Width="143,62214" Height="30,23624" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Посада" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo18" Left="0" Top="0" Width="26,45671" Height="30,23624" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" Memo.Text="№" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo19" Left="665,19728" Top="0" Width="52,91342" Height="30,23624" StretchMode="smMaxHeight" DataSet="ReportDSetDataPeople" DataSetName="ReportDSetDataPeople" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Примітки" ParentFont="False" VAlign="vaCenter"/>
    </TfrxHeader>
    <TfrxReportSummary Name="ReportSummary1" Height="22,67718" Left="0" Top="359,05535" Width="718,1107" OnAfterCalcHeight="ReportSummary1OnAfterCalcHeight"/>
  </TfrxReportPage>
</TfrxReport>
